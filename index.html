<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scripts</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: rgb(25, 25, 25);
            color: #d4d4d4;
            overflow-x: hidden;
            padding: 0;
        }

        .tabs-container {
            background: rgb(20, 25, 35);
            border-bottom: 2px solid rgb(45, 50, 60);
            padding: 8px 20px 0 20px;
            display: flex;
            align-items: flex-end;
            gap: 4px;
            overflow-x: auto;
            overflow-y: hidden;
        }

        .tabs-container::-webkit-scrollbar {
            height: 4px;
        }

        .tabs-container::-webkit-scrollbar-track {
            background: rgb(20, 25, 35);
        }

        .tabs-container::-webkit-scrollbar-thumb {
            background: rgb(60, 65, 75);
            border-radius: 2px;
        }

        .tab {
            background: rgb(30, 35, 45);
            border: 2px solid rgb(45, 50, 60);
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            padding: 10px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 140px;
            max-width: 200px;
            position: relative;
        }

        .tab:hover {
            background: rgb(35, 40, 50);
        }

        .tab.active {
            background: rgb(25, 25, 25);
            border-color: rgb(60, 65, 75);
            border-bottom: 2px solid rgb(25, 25, 25);
            margin-bottom: -2px;
        }

        .tab-title {
            flex: 1;
            font-size: 13px;
            font-weight: 500;
            color: #d4d4d4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .tab-close {
            background: transparent;
            border: none;
            color: #969696;
            font-size: 16px;
            cursor: pointer;
            padding: 2px 4px;
            line-height: 1;
            transition: all 0.2s;
            border-radius: 4px;
        }

        .tab-close:hover {
            background: rgb(60, 65, 75);
            color: #ff6b35;
        }

        .tab-add {
            background: rgb(30, 35, 45);
            border: 2px solid rgb(45, 50, 60);
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            padding: 10px 14px;
            color: #ff6b35;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            line-height: 1;
            min-width: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tab-add:hover {
            background: rgb(40, 45, 55);
            color: #ff8555;
        }

        .tab-content {
            display: none;
            padding: 40px 20px;
        }

        .tab-content.active {
            display: block;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .search-section {
            margin-bottom: 48px;
        }

        .search-bar {
            display: flex;
            gap: 0;
            max-width: 800px;
            margin: 0 auto;
        }

        .search-input {
            flex: 1;
            background: rgb(30, 35, 45);
            border: 2px solid rgb(45, 50, 60);
            border-right: none;
            border-radius: 8px 0 0 8px;
            padding: 16px 20px;
            color: #d4d4d4;
            font-size: 15px;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: rgb(60, 65, 75);
        }

        .search-input::placeholder {
            color: #6e6e6e;
        }

        .search-btn {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: background 0.2s;
        }

        .search-btn:hover {
            background: #ff8555;
        }

        .search-btn:active {
            background: #e65525;
        }

        .loading {
            text-align: center;
            padding: 80px 20px;
            color: #969696;
            font-size: 15px;
        }

        .spinner {
            border: 3px solid rgb(60, 60, 60);
            border-top: 3px solid #ff6b35;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .scripts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
        }

        .script-card {
            background: rgb(30, 35, 45);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .script-card:hover {
            transform: translateY(-6px);
            border-color: rgb(50, 55, 65);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.5);
        }

        .script-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background: rgb(20, 25, 35);
        }

        .script-content {
            padding: 16px;
        }

        .script-title {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 12px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            min-height: 48px;
        }

        .script-game {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
            padding: 10px;
            background: rgb(20, 25, 35);
            border-radius: 8px;
        }

        .game-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            object-fit: cover;
            background: rgb(40, 45, 55);
        }

        .game-name {
            font-size: 14px;
            color: #a0a0a0;
            font-weight: 500;
            flex: 1;
        }

        .script-meta {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 13px;
            color: #6e6e6e;
            align-items: center;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .verified-badge {
            background: #ff6b35;
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .copy-btn {
            width: 100%;
            background: #ff6b35;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .copy-btn:hover {
            background: #ff8555;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.4);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        .copy-btn.copied {
            background: #28a745;
        }

        .no-results {
            text-align: center;
            padding: 80px 20px;
            color: #969696;
        }

        .no-results h3 {
            font-size: 24px;
            margin-bottom: 12px;
            color: #d4d4d4;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 48px;
            padding-bottom: 40px;
        }

        .page-btn {
            background: rgb(30, 35, 45);
            border: 2px solid rgb(45, 50, 60);
            color: #d4d4d4;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .page-btn:hover:not(:disabled) {
            background: rgb(40, 45, 55);
            border-color: rgb(60, 65, 75);
        }

        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .page-btn.active {
            background: #ff6b35;
            border-color: #ff6b35;
            color: white;
        }
    </style>
</head>
<body>
    <div class="tabs-container" id="tabsContainer"></div>
    
    <div id="tabContents"></div>

    <script>
        let tabs = [];
        let activeTabId = null;
        let nextTabId = 1;

        window.addEventListener('DOMContentLoaded', () => {
            createTab();
        });

        function createTab() {
            const tabId = nextTabId++;
            const tab = {
                id: tabId,
                currentPage: 1,
                currentSearch: ''
            };
            tabs.push(tab);
            
            renderTabs();
            switchToTab(tabId);
            loadScripts(tabId);
        }

        function renderTabs() {
            const tabsContainer = document.getElementById('tabsContainer');
            tabsContainer.innerHTML = '';
            
            tabs.forEach((tab, index) => {
                const tabElement = document.createElement('div');
                tabElement.className = 'tab' + (tab.id === activeTabId ? ' active' : '');
                tabElement.innerHTML = `
                    <span class="tab-title">Tab ${index + 1}</span>
                    <button class="tab-close" onclick="closeTab(${tab.id}, event)">√ó</button>
                `;
                tabElement.onclick = (e) => {
                    if (!e.target.classList.contains('tab-close')) {
                        switchToTab(tab.id);
                    }
                };
                tabsContainer.appendChild(tabElement);
            });
            
            const addButton = document.createElement('button');
            addButton.className = 'tab-add';
            addButton.textContent = '+';
            addButton.onclick = createTab;
            tabsContainer.appendChild(addButton);
        }

        function closeTab(tabId, event) {
            event.stopPropagation();
            
            if (tabs.length === 1) {
                return; // Don't close the last tab
            }
            
            const tabIndex = tabs.findIndex(t => t.id === tabId);
            tabs.splice(tabIndex, 1);
            
            // Remove tab content
            const tabContent = document.getElementById(`tab-content-${tabId}`);
            if (tabContent) {
                tabContent.remove();
            }
            
            // If we closed the active tab, switch to another
            if (tabId === activeTabId) {
                const newActiveTab = tabs[Math.max(0, tabIndex - 1)];
                switchToTab(newActiveTab.id);
            }
            
            renderTabs();
        }

        function switchToTab(tabId) {
            activeTabId = tabId;
            
            // Update tab styles
            renderTabs();
            
            // Show/hide tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            let tabContent = document.getElementById(`tab-content-${tabId}`);
            if (!tabContent) {
                tabContent = createTabContent(tabId);
            }
            tabContent.classList.add('active');
        }

        function createTabContent(tabId) {
            const tabContents = document.getElementById('tabContents');
            const content = document.createElement('div');
            content.id = `tab-content-${tabId}`;
            content.className = 'tab-content';
            content.innerHTML = `
                <div class="container">
                    <div class="search-section">
                        <div class="search-bar">
                            <input type="text" class="search-input" id="searchInput-${tabId}" placeholder='Try "jailbreak"' />
                            <button class="search-btn" onclick="searchScripts(${tabId})">Search</button>
                        </div>
                    </div>

                    <div id="loading-${tabId}" class="loading">
                        <div class="spinner"></div>
                        <p>Loading scripts...</p>
                    </div>
                    <div id="scriptsGrid-${tabId}" class="scripts-grid" style="display: none;"></div>
                    <div id="noResults-${tabId}" class="no-results" style="display: none;">
                        <h3>No scripts found</h3>
                        <p>Try a different search term</p>
                    </div>
                    <div id="pagination-${tabId}" class="pagination" style="display: none;"></div>
                </div>
            `;
            
            tabContents.appendChild(content);
            
            // Add enter key listener
            const searchInput = document.getElementById(`searchInput-${tabId}`);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchScripts(tabId);
                }
            });
            
            return content;
        }

        function getTab(tabId) {
            return tabs.find(t => t.id === tabId);
        }

        function searchScripts(tabId) {
            const tab = getTab(tabId);
            const searchInput = document.getElementById(`searchInput-${tabId}`);
            tab.currentSearch = searchInput.value.trim();
            tab.currentPage = 1;
            loadScripts(tabId);
        }

        async function loadScripts(tabId) {
            const tab = getTab(tabId);
            showLoading(tabId, true);
            
            try {
                let url = '';
                
                if (tab.currentSearch) {
                    url = `https://scriptblox.com/api/script/search?q=${encodeURIComponent(tab.currentSearch)}&page=${tab.currentPage}`;
                } else {
                    url = `https://scriptblox.com/api/script/fetch?page=${tab.currentPage}`;
                }

                const response = await fetch(url);
                const data = await response.json();
                
                displayScripts(tabId, data.result.scripts);
                displayPagination(tabId, data.result.totalPages, tab.currentPage);
                
            } catch (error) {
                console.error('Error fetching scripts:', error);
                showError(tabId);
            }
        }

        function displayScripts(tabId, scripts) {
            const grid = document.getElementById(`scriptsGrid-${tabId}`);
            const noResults = document.getElementById(`noResults-${tabId}`);
            
            showLoading(tabId, false);
            
            if (!scripts || scripts.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            noResults.style.display = 'none';
            grid.innerHTML = '';
            
            scripts.forEach(script => {
                const card = createScriptCard(script);
                grid.appendChild(card);
            });
        }

        function createScriptCard(script) {
            const card = document.createElement('div');
            card.className = 'script-card';
            
            const gameName = script.game?.name || 'Universal';
            const imageUrl = script.image;
            const gameIcon = script.game?.imageUrl || script.image;
            
            card.innerHTML = `
                <img src="${imageUrl}" alt="${script.title}" class="script-image">
                <div class="script-content">
                    <div class="script-title">${escapeHtml(script.title)}</div>
                    <div class="script-game">
                        <img src="${gameIcon}" alt="${gameName}" class="game-icon">
                        <span class="game-name">${escapeHtml(gameName)}</span>
                    </div>
                    <div class="script-meta">
                        ${script.verified ? '<span class="verified-badge">‚úì Verified</span>' : ''}
                        <span class="meta-item">üëÅÔ∏è ${formatViews(script.views || 0)}</span>
                    </div>
                    <button class="copy-btn" onclick="copyScript('${script.slug}', event)">
                        Copy Script
                    </button>
                </div>
            `;
            
            return card;
        }

        async function copyScript(slug, event) {
            event.stopPropagation();
            const button = event.target;
            const originalText = button.innerHTML;
            
            try {
                button.disabled = true;
                button.innerHTML = 'Loading...';
                
                const response = await fetch(`https://scriptblox.com/api/script/${slug}`);
                const data = await response.json();
                
                await navigator.clipboard.writeText(data.script.script);
                
                button.classList.add('copied');
                button.innerHTML = '‚úì Copied!';
                
                setTimeout(() => {
                    button.classList.remove('copied');
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error copying script:', error);
                button.innerHTML = '‚ùå Error';
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000);
            }
        }

        function displayPagination(tabId, totalPages, currentPageNum) {
            const tab = getTab(tabId);
            const pagination = document.getElementById(`pagination-${tabId}`);
            
            if (totalPages <= 1) {
                pagination.style.display = 'none';
                return;
            }
            
            pagination.style.display = 'flex';
            pagination.innerHTML = '';
            
            const prevBtn = document.createElement('button');
            prevBtn.className = 'page-btn';
            prevBtn.textContent = '‚Üê Previous';
            prevBtn.disabled = currentPageNum === 1;
            prevBtn.onclick = () => {
                if (currentPageNum > 1) {
                    tab.currentPage--;
                    loadScripts(tabId);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            };
            pagination.appendChild(prevBtn);
            
            const maxButtons = 5;
            let startPage = Math.max(1, currentPageNum - Math.floor(maxButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxButtons - 1);
            
            if (endPage - startPage < maxButtons - 1) {
                startPage = Math.max(1, endPage - maxButtons + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = 'page-btn' + (i === currentPageNum ? ' active' : '');
                pageBtn.textContent = i;
                pageBtn.onclick = () => {
                    tab.currentPage = i;
                    loadScripts(tabId);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };
                pagination.appendChild(pageBtn);
            }
            
            const nextBtn = document.createElement('button');
            nextBtn.className = 'page-btn';
            nextBtn.textContent = 'Next ‚Üí';
            nextBtn.disabled = currentPageNum === totalPages;
            nextBtn.onclick = () => {
                if (currentPageNum < totalPages) {
                    tab.currentPage++;
                    loadScripts(tabId);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            };
            pagination.appendChild(nextBtn);
        }

        function showLoading(tabId, show) {
            document.getElementById(`loading-${tabId}`).style.display = show ? 'block' : 'none';
            document.getElementById(`scriptsGrid-${tabId}`).style.display = show ? 'none' : 'grid';
        }

        function showError(tabId) {
            showLoading(tabId, false);
            document.getElementById(`noResults-${tabId}`).style.display = 'block';
            document.getElementById(`noResults-${tabId}`).innerHTML = `
                <h3>Error loading scripts</h3>
                <p>Please try again later</p>
            `;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatViews(views) {
            if (views >= 1000000) {
                return (views / 1000000).toFixed(1) + 'M';
            } else if (views >= 1000) {
                return (views / 1000).toFixed(1) + 'K';
            }
            return views.toString();
        }
    </script>
</body>
</html>
